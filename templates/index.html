<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Breast Cancer Classifier | Dept of CE, PIET</title>

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        body {
            background: linear-gradient(135deg, #f5f7fa, #c3cfe2);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            min-height: 100vh;
        }
        .header-bar {
            background: linear-gradient(90deg, #2c3e50, #4a6491);
            color: white;
            padding: 1.5rem 0;
            border-bottom: 5px solid #3498db;
        }
        .main-card {
            border-radius: 20px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            margin-top: -50px;
        }
        .result-panel {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 2rem;
        }
        .malignant { color: #e74c3c; border-left: 5px solid #e74c3c; }
        .benign { color: #27ae60; border-left: 5px solid #27ae60; }
        .progress-bar-malignant { background-color: #e74c3c; }
        .progress-bar-benign { background-color: #27ae60; }
        .badge-note { font-size: 0.85rem; }
    </style>
</head>

<body>

<!-- HEADER -->
<div class="header-bar">
    <div class="container d-flex justify-content-between align-items-center">
        <div>
            <h1><i class="fas fa-hospital-alt"></i> Breast Cancer Wisconsin Classifier</h1>
            <p class="lead mb-0">Machine Learning‚ÄìBased Diagnostic Assistance</p>
        </div>
        <span class="badge bg-primary fs-6">
            <i class="fas fa-university"></i> Dept of CE, PIET Jaipur
        </span>
    </div>
</div>

<!-- MAIN -->
<div class="container py-5">
    <div class="card main-card p-5">

        <!-- INTRO -->
        <div class="mb-4">
            <span class="badge bg-info text-dark badge-note">
                Supervised ML Model ¬∑ Using 5 of 30 trained features
            </span>
            <h2 class="mt-3">Interactive Tumor Analysis</h2>
            <p class="text-muted">
                Predictions are based on combined feature patterns, not on individual thresholds.
            </p>
            <div class="alert alert-warning">
                ‚ö†Ô∏è This is an <strong>educational tool</strong>. Predictions are not medical diagnoses.
            </div>
        </div>

        <div class="row">
            <!-- INPUT -->
            <div class="col-md-7">
                <h4><i class="fas fa-sliders-h"></i> Input Tumor Features</h4>
                <div id="featureInputs" class="mt-3 text-muted">
                    Loading sliders‚Ä¶
                </div>

                <button id="predictBtn" class="btn btn-primary btn-lg w-100 mt-4"
                        onclick="makePrediction()">
                    <i class="fas fa-stethoscope"></i> Analyze & Predict
                </button>

                <div id="loadingSpinner" class="text-center mt-3" style="display:none;">
                    <div class="spinner-border text-primary"></div>
                    <p>Analyzing‚Ä¶</p>
                </div>
            </div>

            <!-- RESULTS -->
            <div class="col-md-5">
                <h4><i class="fas fa-chart-line"></i> Prediction Results</h4>
                <div id="resultPanel" class="result-panel text-center text-muted">
                    Awaiting analysis‚Ä¶
                </div>
            </div>
        </div>

        <div class="alert alert-secondary mt-4">
            üìå <strong>Important:</strong> Model confidence reflects statistical certainty,
            <em>not</em> clinical certainty.
        </div>
    </div>
</div>

<!-- FOOTER -->
<footer class="bg-dark text-light p-4 mt-5">
    <div class="container text-center">
        <p class="mb-1">Academic Project ¬∑ Department of Computer Engineering</p>
        <p class="mb-0">
            ¬© 2024 ¬∑ Ms. Bersha Kumari, Assistant Professor, PIET Jaipur
        </p>
    </div>
</footer>

<!-- JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
document.addEventListener('DOMContentLoaded', () => {
    fetch('/api/feature_ranges')
        .then(r => r.json())
        .then(data => {
            const container = document.getElementById('featureInputs');
            container.innerHTML = '';
            data.features.forEach(f => {
                container.innerHTML += `
                <label class="form-label">
                    <strong>${f.display_name}</strong>
                    <span id="v_${f.name}" class="float-end">${f.default.toFixed(2)}</span>
                </label>
                <input type="range" class="form-range feature-slider"
                       id="slider_${f.name}" min="${f.min}" max="${f.max}"
                       step="${f.step}" value="${f.default}"
                       oninput="document.getElementById('v_${f.name}').innerText=parseFloat(this.value).toFixed(2)">
                `;
            });
        });
});

function makePrediction() {
    const btn = document.getElementById('predictBtn');
    const spinner = document.getElementById('loadingSpinner');
    const panel = document.getElementById('resultPanel');

    btn.disabled = true;
    spinner.style.display = 'block';

    const inputs = {};
    document.querySelectorAll('.feature-slider').forEach(s => {
        inputs[s.id.replace('slider_', '')] = parseFloat(s.value);
    });

    fetch('/api/predict', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(inputs)
    })
    .then(r => r.json())
    .then(data => {
        if (data.error) throw new Error(data.error);

        const malignant = data.prediction === 0;
        panel.innerHTML = `
        <div class="${malignant ? 'malignant' : 'benign'} p-3">
            <h3>${malignant ? 'MALIGNANT' : 'BENIGN'}</h3>
            <p>Model Confidence: ${data.confidence.toFixed(1)}%</p>
        </div>`;
    })
    .catch(err => {
        panel.innerHTML = `<div class="alert alert-danger">${err.message}</div>`;
    })
    .finally(() => {
        btn.disabled = false;
        spinner.style.display = 'none';
    });
}
</script>

</body>
</html>
